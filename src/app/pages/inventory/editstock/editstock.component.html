
<div class="col-md-12">
    <nb-card>
        <nb-card-header>Create Stock Details</nb-card-header>

        <nb-card-body>
            <form [formGroup]="editstockForm" class="form-horizontal" (ngSubmit)="addstockIn();">
                <div class="modal-body">
                    <nb-tabset>
                        <nb-tab tabTitle="Stock Details">
                          <div class="modal-body">
                            <div class="form-group row">


<div class ="col-sm-6">
<label>Headend Name<span style="color:red">*</span></label>
<auto-completen
[addclass]="{'form-control':true,'form-control-danger':editstockForm.controls.hdid.invalid&&submit}"
addclass="form-control" optValues="hdname" (changed)="gethsnlistg();getModel();getVendor();typeclearHeadend('1')"
formControlName="hdid" (keyUp)="getHeadend($event)"
placeholder='Select Headend'  optId="hdid"
[item]="listhead">
</auto-completen>
</div>
                          

                            </div>  
                            <div class="form-group row">
                              <div class="col-sm-6">
                                <label>Vendor </label>
                                    <auto-completen
                                    [addclass]="{'form-control':true,'form-control-danger':editstockForm.controls.vendorid.invalid&&submit}"
                                    addclass="form-control" optValues="vendor_name" (changed)="getlocation();typeclearVendor('1')"
                                    formControlName="vendorid" (keyUp)="getVendor()"
                                     placeholder='Select State' optId="vendorid"
                                    [item]="getvendorlist">
                                  </auto-completen>
                                    
                                  </div>

                              <div class="col-sm-6">
                                <label>Location</label>
                                <auto-completen
                                [addclass]="{'form-control':true,'form-control-danger':editstockForm.controls.vendordetid.invalid&&submit}"
                                addclass="form-control" optValues="loc" 
                                formControlName="vendordetid" (keyUp)="getlocation()"
                                 placeholder='Select Loction' optId="vendordetid"
                                [item]="locationlist">
                              </auto-completen>
                              </div>
                            </div>
                            
                            <div class="form-group row">
                              <div class="col-sm-6">
                                <label>Stock Type</label>
                                <select [ngClass]="{ 'is-invalid': submit && editstockForm.controls.stocktype.errors }" class="form-control" name="stocktype" formControlName="stocktype">
                                  <option value="" selected>Select Stock Type</option>
                                  <option value="1">New </option>
                                  <option value="2">Refurbished</option>
                                </select>
                                <small *ngIf="editstockForm.controls.stocktype.errors &&(editstockForm.controls.stocktype.errors.required )&& submit"
                                class="invalid-feedback">Stock Type is required! </small>
                              </div>
                              <div class="col-sm-6">
                                <label>Warranty Type</label>
                                <select [ngClass]="{ 'is-invalid': submit && editstockForm.controls.warranty_type.errors }" class="form-control" name="warranty_type" formControlName="warranty_type">
                                  <option value="" selected>Select Required Warranty Type</option>
                                  <option value="1">Month</option>
                                  <option value="2">Year</option>
                                </select>
                                <small *ngIf="editstockForm.controls.warranty_type.errors &&(editstockForm.controls.warranty_type.errors.required )&& submit"
                                class="invalid-feedback">Warranty Type is required! </small>
                              </div>

                            </div>

                            <div class="form-group row">

                            <div class="col-sm-6" >
                              <label>HSN/SAC</label>
                              <auto-completen
                                [addclass]="{'form-control':true,'form-control-danger':editstockForm.controls.hsnid.invalid&&submit}"
                                addclass="form-control" optValues="hsn_name" 
                                formControlName="hsnid" (keyUp)="gethsnlistg()"
                                 placeholder='Select hsn' optId="hsn_id"
                                [item]="gethsn">
                              </auto-completen>
                            </div>
                             
                            <div class="col-sm-6">
                              <label>Warranty Period</label>
                                <input type="text" class="form-control" name="warranty_period" formControlName="warranty_period" placeholder="Enter Warranty Period"
                                [ngClass]="{ 'is-invalid': submit && editstockForm.controls.warranty_period.errors }"/>
                                <small *ngIf="editstockForm.controls.warranty_period.errors &&(editstockForm.controls.warranty_period.errors.required )&& submit"
                                  class="invalid-feedback">Warranty Period is required! </small>
                            </div>
                            </div>
                            <!-- <div class="form-group row">
                             
                            
                              </div> -->
                             
                      </div>
                        </nb-tab>
                        <nb-tab tabTitle="Invoice Details">
                            <div class="modal-body">
                                <div class="form-group row">
                                                    <div class="col-sm-6">
                                                          <label>Invoice <span style="color:red">*</span></label>
                                                          <input type="date" class="form-control" formControlName="invoice_date" />
                                                       </div>
                                                       <div class="col-sm-6">
                                                        <label>Invoice No</label>
                                                        <input type="text" name="invoiceno" formControlName="invoiceno" placeholder="Package Name " [ngClass]="{
                                                            'form-control': true,
                                                            'form-control-danger':
                                                              editstockForm.controls.invoiceno.invalid && submit}" />
                                              
                                                      </div>
                                                </div>
                                         </div>
                        </nb-tab>
                        <nb-tab tabTitle="Material Details ">
                          <div class="modal-body">
                            <div class="form-group row" formArrayName="stockinid">
                              <div class="col-sm-12">
                                <div *ngFor="let user of stockinid.controls; index as idx;let last = last;">
                                  <div class="row" [formGroupName]="idx">
                                    <!-- <div class="row"> -->
                                      <div class="form-group" class="col-sm-3">
                                        <label>Model*</label>
                                                <auto-completen
                                                addclass="form-control" optValues="modelname"
                                                formControlName="boxmodelid" (keyUp)="getModel() "
                                                 placeholder='Select Model' optId="bmid"
                                                [item]="getmodellist">
                                              </auto-completen>
                                      </div>
                                      <div class="form-group" class="col-sm-3">
                                        <label>Quantity*</label>
                                        <input type="number" name="qty" formControlName="qty" placeholder="Enter Quantity"  class ="form-control"
                                        (keyup)="onkeyupQty($event, idx)"   /></div>
                                      <div class="form-group" class="col-sm-3">
                                        <label>Price*</label>
                                                    <input type="number" name="price" formControlName="price" placeholder="Enter Price"  class ="form-control" (keyup)="onkeyupQty($event, idx)" />
          
                                      </div>
                                      <div class="form-group" class="col-sm-2">
                                        <label>Total</label>
                                                    <input type="number" name="total" formControlName="total" placeholder="Total" 
                                                    class ="form-control" (keyup)="onkeyupQty($event, idx)"/>
                                      </div>

                              <div class="form-group" class="col-sm-1"  *ngIf="last || idx !=0">
                                 <div class="btn-group" >
                                 <button type="button"   style="margin-top: 31%;"class="btn btn-md btn-success dropdown-toggle" data-bs-toggle="dropdown">Action</button>
                                 <div class="dropdown-menu">
                                     <a (click)="deleteMatField(idx)"  class="dropdown-item" *ngIf="idx !=0"><i title="Edit Complaint" class="ion-android-delete"></i>&nbsp;Delete</a>                                
                                     <a (click)="addMaterial()" class="dropdown-item" *ngIf="last"><i title="Edit Complaint" class="ion-ios-plus-outline"></i>&nbsp;ADD </a>    
                                 </div>
                             </div>
                           </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                         </nb-tab>
                    </nb-tabset>
                </div>
                <div class="modal-footer">
                    <button type="submit"  status="success" nbButton >Add </button>
                    <button type="button" status="danger" nbButton  >Reset </button>
                </div>
            </form>
        </nb-card-body>
    </nb-card>
</div>